#######################################
# Сенсоры дня и ночи (авто и графики) #
#######################################

- platform: template
  sensors:

    daytime:
      icon_template: mdi:sun-clock-outline
      friendly_name: "Дневное время"
      value_template: >
        {% set state = states('sensor.time') %}
        {% if states('binary_sensor.workday_sensor') %}
          {% set morning = states('input_datetime.wakeup_time') [0:5] %}
        {% else %}
          {% set morning = '12:00' %}
        {% endif %}
        {% if states('input_datetime.sleep_time') [0:5] < '12:00' %}
          {% set evening = '24:00' %}
        {% else %}
          {% set evening = states('input_datetime.sleep_time') [0:5] %}
        {% endif %}
        {% if morning < state < evening %}
          on
        {% else %}
          off
        {% endif %}

    mini_graph_day_pct:
      friendly_name: "День (Процент)"
      value_template: "{{ 100 if is_state('sun.sun', 'above_horizon') else 0 }}"
      availability_template: "{{ states('sun.sun') not in ['unknown', 'unavailable'] }}"
      icon_template: mdi:theme-light-dar

    mini_graph_night_pct:
      friendly_name: "Ночь (Процент)"
      value_template: "{{ 0 if is_state('sun.sun', 'above_horizon') else 100 }}"
      availability_template: "{{ states('sun.sun') not in ['unknown', 'unavailable'] }}"
      icon_template: mdi:theme-light-dark